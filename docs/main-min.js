function paymentBtnClicked(a){a.stopPropagation();let e=$(a.currentTarget);return $(".payment-btn").removeClass("active"),e.addClass("active"),e.hasClass("credit-btn")?($(".select-line").removeClass().addClass("select-line").addClass("credit-line"),$(".payment-info-pane").removeClass("active"),$(".credit-pane").addClass("active"),setValidation(),void caculateTotal()):e.hasClass("shop-btn")?($(".select-line").removeClass().addClass("select-line").addClass("shop-line"),$(".payment-info-pane").removeClass("active"),$(".shop-pane").addClass("active"),setValidation(),void caculateTotal()):e.hasClass("atm-btn")?($(".select-line").removeClass().addClass("select-line").addClass("atm-line"),$(".payment-info-pane").removeClass("active"),$(".atm-pane").addClass("active"),setValidation(),void caculateTotal()):void 0}function caculateTotal(){var a=$(".side-pane li span").length;$(".shop-pane").hasClass("active")?$(".extra").addClass("show"):($(".extra").removeClass("show"),a-=$(".extra li span").length);let e=0;for(var t=0;t<a;t++){var i=parseInt($($(".side-pane li span")[t]).html());console.log(i),e+=i,console.log(e)}$(".total").html(e)}function inputFocused(a){a.stopPropagation();let e=$(a.currentTarget);switch(e.removeClass("hint"),e.attr("id")){case"cardno1":case"cardno2":case"cardno3":case"cardno4":"0000"==e.val()&&e.val("");break;case"cardno":"0000-0000-0000-0000"==e.val()&&e.val("");break;case"month":"MM"==e.val()&&e.val("");break;case"year":"YYYY"==e.val()&&e.val("");break;case"cvv":"CVV"==e.val()&&e.val("")}}function inputFocusedOut(a){a.stopPropagation();let e=$(a.currentTarget);switch(e.attr("id")){case"cardno1":case"cardno2":case"cardno3":case"cardno4":""==e.val()&&(e.val("0000"),e.addClass("hint"));break;case"cardno":""==e.val()&&(e.val("0000-0000-0000-0000"),e.addClass("hint"));break;case"month":""==e.val()&&(e.val("MM"),e.addClass("hint")),updateDateValidation();break;case"year":""==e.val()&&(e.val("YYYY"),e.addClass("hint")),updateDateValidation();break;case"cvv":""==e.val()&&(e.val("CVV"),e.addClass("hint"))}}function cardNumTweak(a){let e=$(a.currentTarget),t=e.val().split("-").join("");if(t.length>0){let a=getCardType(t);""!=a?($(".cardicon").text(a),$(".cardicon").css("visibility","visible")):$(".cardicon").css("visibility","hidden"),t=t.match(new RegExp(".{1,4}","g")).join("-")}e.val(t)}function getCardType(a){if(!luhnCheck(a))return"";for(var e="",t=[{regEx:/^4[0-9]{12}(?:[0-9]{3})?/gi,cardType:"VISA"},{regEx:/^5[1-5][0-9]{14}/gi,cardType:"MASTERCARD"},{regEx:/^3[47][0-9]{13}/gi,cardType:"AMEX"},{regEx:/^(?:2131|1800|35\d{3})\d{11}/gi,cardType:"JCB"}],i=0;i<t.length;i++)if(a.match(t[i].regEx)){e=t[i].cardType;break}return e}function luhnCheck(a){if(!/^[\d\-\s]+$/.test(a))return!1;for(var e=0,t=0,i=!1,n=a.replace(/\D/g,""),s=n.length-1;s>=0;s--){var l=n.charAt(s);t=parseInt(l,10),i&&(t*=2)>9&&(t-=9),e+=t,i=!i}return 0!==e&&e%10==0}function submitClicked(a){console.log("submit"),$(".payment-info>.active>form").submit()}function initValidation(){window.Parsley.addValidator("cardno",{validateString:function(a){return luhnCheck(a)},messages:{en:"This is not a valid credit card number"}}),setValidation()}function setValidation(){$(".payment-info>.active>form").parsley().destroy(),$(".custom-error").html(""),$(".payment-info>.active>form").parsley().on("form:validate",function(a){if($(".payment-info>.active").hasClass("credit-pane")){console.log("credit pane");var e=a.isValid({group:"date",force:!0});$(".date-validationResult").html(e?"":"expiration date is valid").toggleClass("filled",!e);var t=a.isValid();$(".form-item").css("margin-bottom",t?"20px":"10px"),$(".cardicon").css("display",t?"block":"none")}e||(a.validationResult=!1)}),$(".payment-info>.active>form").parsley().on("form:success",function(){alert("pass")})}function updateDateValidation(){var a=$(".payment-info>.active>form").parsley().isValid({group:"date",force:!0});$(".date-validationResult").html(a?"":"expiration date is valid").toggleClass("filled",!a)}$(document).ready(function(){$(".payment-btn").on("click",paymentBtnClicked),$("input").on("focus",inputFocused),$("input").on("focusout",inputFocusedOut),$("#cardno").on("keyup",cardNumTweak),$(".submit-btn").on("click",submitClicked),initValidation()});